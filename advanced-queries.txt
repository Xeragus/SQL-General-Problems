# 0. FIND THE TOTAL CONSULTANT'S PROFIT, FOR EVERY CONSULTANT SEPARATELY
SELECT CONSULTANTID, SUM(SUMA)
FROM(
	SELECT ORR.ORDERID, ORR.CONSULTANTID, SUMA
	FROM (
		SELECT ORDERID,SUM(VALUE) AS SUMA
		FROM (
		SELECT O.* ,P.PRODUCTPRICE, O.QUANTITY*P.PRODUCTPRICE AS VALUE
		FROM ORDERDETAILS O, PRODUCTS P, ORDERS OO
		WHERE O.PRODUCTID = P.PRODUCTID AND O.ORDERID = OO.ORDERID
		)
		GROUP BY ORDERID
	) N, ORDERS ORR
	WHERE N.ORDERID = ORR.ORDERID
)
GROUP BY CONSULTANTID

# 1. FIND ALL THE CONSULTANTS WITH LAST NAME STARTING WITH 'P'
SELECT *
FROM CONSULTANTS
WHERE CONSULTANTNAME LIKE 'P%'

# 2. FIND ALL THE CONSULTANTS WITH LAST NAME ENDING WITH 'SKA', AND FIRST NAME
# BEGINNING WITH 'M'
SELECT *
FROM CONSULTANTS
WHERE CONSULTANTNAME LIKE '%SKA M%'

# 3. FIND ALL THE CONSULTANTS WITH NAMES THAT ARE 5 CHARACTERS LONG
SELECT *
FROM CONSULTANTS
WHERE CONSULTANTNAME LIKE '_____'

# 4. SHOW ALL THE PRODUCTS THAT HAVE 2 WORDS IN THEIR NAME
SELECT *
FROM PRODUCTS
WHERE PRODUCTNAME LIKE '% %'

# 5. SHOW ALL THE PRODUCTS WITH NAME THAT CONTAINS THE LETTER 'D' (UPPERCASE AND LOWERCASE)
SELECT *
FROM PRODUCTS
WHERE PRODUCTNAME LIKE '%D%' OR PRODUCTNAME LIKE '%D%'

# 6. RETURN THE NAMES OF THE PRODUCTS THAT ARE NOT ORDERED IN ANY ORDER
# 6.1
(SELECT PRODUCTNAME
FROM PRODUCTS)
MINUS
(SELECT PRODUCTNAME
FROM PRODUCTS, ORDERDETAILS
WHERE PRODUCTS.PRODUCTID == ORDERDETAILS.PRODUCTID)

# 6.2

# 7. FIND THE TOTAL PROFIT SEPARATELY FOR EVERY ORDER
SELECT ORDERID, SUM(PRICE)
FROM 
(SELECT ORDERDETAILS.*, PRODUCTS.PRODUCTPRICE, ORDERDETAILS.QUANTITY*PRODUCTS.PRODUCTPRICE AS PRICE
FROM PRODUCTS, ORDERDETAILS,
WHERE PRODUCTS.PRODUCTID = ORDERDETAILS.PRODUCTID)
GROUP BY ORDERID

# 8. FIND THE PRODUCTS THAT ARE ORDERED IN AT LEAST 2 ORDERS
SELECT PRODUCTNAME, ORDER_COUNT
FROM 
(
SELECT PRODUCTID, COUNT(PRODUCTID) AS ORDER_COUNT
FROM ORDERDETAILS
GROUP BY PRODUCTID
)
WHERE ORDER_COUNT > 1

